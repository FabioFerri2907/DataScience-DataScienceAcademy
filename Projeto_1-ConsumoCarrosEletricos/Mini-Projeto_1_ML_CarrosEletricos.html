
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.42</code>)
    .</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Mini-Projeto_1 - Machine Learning em Logística Prevendo o Consumo de Energia de Carros Elétricos</span>
<span class="hl com"># Curso1-BigDataAzureMachineLearning</span>
<span class="hl com"># Julho/2023</span>
<span class="hl com"># Fabio Ferri </span>
</pre></div>
</div></div>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##### Problema de Negócio #####</span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#Uma empresa da área de transporte e logística deseja migrar sua frota para carros elétricos com o objetivo de reduzir os custos.</span>
<span class="hl com">#Antes de tomar a decisão, a empresa gostaria de prever o consumo de energia de carros elétricos com base em diversos fatores de utilização e características dos veículos.</span>

<span class="hl com"># Usando um incrível dataset com dados reais disponíveis publicamente, você deverá construir um modelo de Machine Learning capaz de prever o consumo de energia de carros elétricos com base em diversos fatores, tais como o tipo e número de motores elétricos do veículo, o peso do veículo, a capacidade de carga, entre outros atributos.</span>

<span class="hl com"># Data Set </span>
<span class="hl com">#https://data.mendeley.com/datasets/tb9yrptydn/2</span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##### Instala os pacotes #####</span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">setwd</span><span class="hl std">(</span><span class="hl str">&quot;C:/Users/FFERRI/Documents/Desenvolvimento/DataScienceAcademy/FormacaoCietistadeDados/Curso1-BigDataAzureMachineLearning/20-ProjetosComFeedback/Projetos-1-2/Projeto_1-ConsumoCarrosEletricos&quot;</span><span class="hl std">)</span>
<span class="hl kwd">getwd</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;C:/Users/FFERRI/Documents/Desenvolvimento/DataScienceAcademy/FormacaoCietistadeDados/Curso1-BigDataAzureMachineLearning/20-ProjetosComFeedback/Projetos-1-2/Projeto_1-ConsumoCarrosEletricos&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#install.packages(&quot;LiblineaR&quot;)</span>
<span class="hl com">#0stall.packages(&quot;Metrics&quot;)</span>

<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;caret&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;readxl&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;corrplot&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;dplyr&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;ggplot2&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;randomForest&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;varImp&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;readxl&quot;</span><span class="hl std">)</span>
<span class="hl kwd">library</span><span class="hl std">(e1071)</span>
<span class="hl kwd">library</span><span class="hl std">(Metrics)</span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##### Análise Exploratória dos Dados - Limpeza dos Dados ##### </span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Importando uma worksheet para um dataframe</span>
<span class="hl std">df_dados</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read_excel</span><span class="hl std">(</span><span class="hl str">&quot;FEV-data-Excel.xlsx&quot;</span><span class="hl std">,</span> <span class="hl kwc">sheet</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">)</span>
<span class="hl kwd">View</span><span class="hl std">(df_dados)</span>


<span class="hl com"># Variáveis e tipos de dados</span>
<span class="hl kwd">str</span><span class="hl std">(df_dados)</span>
</pre></div>
<div class="output"><pre class="knitr r">## tibble [53 × 25] (S3: tbl_df/tbl/data.frame)
##  $ Car full name                         : chr [1:53] &quot;Audi e-tron 55 quattro&quot; &quot;Audi e-tron 50 quattro&quot; &quot;Audi e-tron S quattro&quot; &quot;Audi e-tron Sportback 50 quattro&quot; ...
##  $ Make                                  : chr [1:53] &quot;Audi&quot; &quot;Audi&quot; &quot;Audi&quot; &quot;Audi&quot; ...
##  $ Model                                 : chr [1:53] &quot;e-tron 55 quattro&quot; &quot;e-tron 50 quattro&quot; &quot;e-tron S quattro&quot; &quot;e-tron Sportback 50 quattro&quot; ...
##  $ Minimal price (gross) [PLN]           : num [1:53] 345700 308400 414900 319700 357000 ...
##  $ Engine power [KM]                     : num [1:53] 360 313 503 313 360 503 170 184 286 136 ...
##  $ Maximum torque [Nm]                   : num [1:53] 664 540 973 540 664 973 250 270 400 260 ...
##  $ Type of brakes                        : chr [1:53] &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; ...
##  $ Drive type                            : chr [1:53] &quot;4WD&quot; &quot;4WD&quot; &quot;4WD&quot; &quot;4WD&quot; ...
##  $ Battery capacity [kWh]                : num [1:53] 95 71 95 71 95 95 42.2 42.2 80 50 ...
##  $ Range (WLTP) [km]                     : num [1:53] 438 340 364 346 447 369 359 345 460 350 ...
##  $ Wheelbase [cm]                        : num [1:53] 293 293 293 293 293 ...
##  $ Length [cm]                           : num [1:53] 490 490 490 490 490 ...
##  $ Width [cm]                            : num [1:53] 194 194 198 194 194 ...
##  $ Height [cm]                           : num [1:53] 163 163 163 162 162 ...
##  $ Minimal empty weight [kg]             : num [1:53] 2565 2445 2695 2445 2595 ...
##  $ Permissable gross weight [kg]         : num [1:53] 3130 3040 3130 3040 3130 ...
##  $ Maximum load capacity [kg]            : num [1:53] 640 670 565 640 670 565 440 440 540 459 ...
##  $ Number of seats                       : num [1:53] 5 5 5 5 5 5 4 4 5 5 ...
##  $ Number of doors                       : num [1:53] 5 5 5 5 5 5 5 5 5 5 ...
##  $ Tire size [in]                        : num [1:53] 19 19 20 19 19 20 19 20 19 16 ...
##  $ Maximum speed [kph]                   : num [1:53] 200 190 210 190 200 210 160 160 180 150 ...
##  $ Boot capacity (VDA) [l]               : num [1:53] 660 660 660 615 615 615 260 260 510 380 ...
##  $ Acceleration 0-100 kph [s]            : num [1:53] 5.7 6.8 4.5 6.8 5.7 4.5 8.1 6.9 6.8 9.5 ...
##  $ Maximum DC charging power [kW]        : num [1:53] 150 150 150 150 150 150 50 50 150 100 ...
##  $ mean - Energy consumption [kWh/100 km]: num [1:53] 24.4 23.8 27.6 23.3 23.9 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Sumários das variáveis numéricas</span>
<span class="hl kwd">summary</span><span class="hl std">(df_dados)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  Car full name          Make              Model           Minimal price (gross) [PLN]
##  Length:53          Length:53          Length:53          Min.   : 82050             
##  Class :character   Class :character   Class :character   1st Qu.:142900             
##  Mode  :character   Mode  :character   Mode  :character   Median :178400             
##                                                           Mean   :246159             
##                                                           3rd Qu.:339480             
##                                                           Max.   :794000             
##                                                                                      
##  Engine power [KM] Maximum torque [Nm] Type of brakes      Drive type       
##  Min.   : 82.0     Min.   : 160        Length:53          Length:53         
##  1st Qu.:136.0     1st Qu.: 260        Class :character   Class :character  
##  Median :204.0     Median : 362        Mode  :character   Mode  :character  
##  Mean   :269.8     Mean   : 460                                             
##  3rd Qu.:372.0     3rd Qu.: 640                                             
##  Max.   :772.0     Max.   :1140                                             
##                                                                             
##  Battery capacity [kWh] Range (WLTP) [km] Wheelbase [cm]   Length [cm]      Width [cm]   
##  Min.   : 17.60         Min.   :148.0     Min.   :187.3   Min.   :269.5   Min.   :164.5  
##  1st Qu.: 40.00         1st Qu.:289.0     1st Qu.:258.8   1st Qu.:411.8   1st Qu.:178.8  
##  Median : 58.00         Median :364.0     Median :270.0   Median :447.0   Median :180.9  
##  Mean   : 62.37         Mean   :376.9     Mean   :273.6   Mean   :442.5   Mean   :186.2  
##  3rd Qu.: 80.00         3rd Qu.:450.0     3rd Qu.:290.0   3rd Qu.:490.1   3rd Qu.:193.5  
##  Max.   :100.00         Max.   :652.0     Max.   :327.5   Max.   :514.0   Max.   :255.8  
##                                                                                          
##   Height [cm]    Minimal empty weight [kg] Permissable gross weight [kg]
##  Min.   :137.8   Min.   :1035              Min.   :1310                 
##  1st Qu.:148.1   1st Qu.:1530              1st Qu.:1916                 
##  Median :155.6   Median :1685              Median :2119                 
##  Mean   :155.4   Mean   :1868              Mean   :2289                 
##  3rd Qu.:161.5   3rd Qu.:2370              3rd Qu.:2870                 
##  Max.   :191.0   Max.   :2710              Max.   :3500                 
##                                            NA's   :8                    
##  Maximum load capacity [kg] Number of seats Number of doors Tire size [in] 
##  Min.   : 290.0             Min.   :2.000   Min.   :3.000   Min.   :14.00  
##  1st Qu.: 440.0             1st Qu.:5.000   1st Qu.:5.000   1st Qu.:16.00  
##  Median : 486.0             Median :5.000   Median :5.000   Median :17.00  
##  Mean   : 520.5             Mean   :4.906   Mean   :4.849   Mean   :17.68  
##  3rd Qu.: 575.0             3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:19.00  
##  Max.   :1056.0             Max.   :8.000   Max.   :5.000   Max.   :21.00  
##  NA's   :8                                                                 
##  Maximum speed [kph] Boot capacity (VDA) [l] Acceleration 0-100 kph [s]
##  Min.   :123.0       Min.   :171.0           Min.   : 2.500            
##  1st Qu.:150.0       1st Qu.:315.0           1st Qu.: 4.875            
##  Median :160.0       Median :425.0           Median : 7.700            
##  Mean   :178.2       Mean   :445.1           Mean   : 7.360            
##  3rd Qu.:200.0       3rd Qu.:558.0           3rd Qu.: 9.375            
##  Max.   :261.0       Max.   :870.0           Max.   :13.100            
##                      NA's   :1               NA's   :3                 
##  Maximum DC charging power [kW] mean - Energy consumption [kWh/100 km]
##  Min.   : 22.0                  Min.   :13.10                         
##  1st Qu.:100.0                  1st Qu.:15.60                         
##  Median :100.0                  Median :17.05                         
##  Mean   :113.5                  Mean   :18.99                         
##  3rd Qu.:150.0                  3rd Qu.:23.50                         
##  Max.   :270.0                  Max.   :28.20                         
##                                 NA's   :9
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Nomes das colunas</span>
<span class="hl kwd">colnames</span><span class="hl std">(df_dados)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;Car full name&quot;                          &quot;Make&quot;                                  
##  [3] &quot;Model&quot;                                  &quot;Minimal price (gross) [PLN]&quot;           
##  [5] &quot;Engine power [KM]&quot;                      &quot;Maximum torque [Nm]&quot;                   
##  [7] &quot;Type of brakes&quot;                         &quot;Drive type&quot;                            
##  [9] &quot;Battery capacity [kWh]&quot;                 &quot;Range (WLTP) [km]&quot;                     
## [11] &quot;Wheelbase [cm]&quot;                         &quot;Length [cm]&quot;                           
## [13] &quot;Width [cm]&quot;                             &quot;Height [cm]&quot;                           
## [15] &quot;Minimal empty weight [kg]&quot;              &quot;Permissable gross weight [kg]&quot;         
## [17] &quot;Maximum load capacity [kg]&quot;             &quot;Number of seats&quot;                       
## [19] &quot;Number of doors&quot;                        &quot;Tire size [in]&quot;                        
## [21] &quot;Maximum speed [kph]&quot;                    &quot;Boot capacity (VDA) [l]&quot;               
## [23] &quot;Acceleration 0-100 kph [s]&quot;             &quot;Maximum DC charging power [kW]&quot;        
## [25] &quot;mean - Energy consumption [kWh/100 km]&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Grava os nomes das colunas em um vetor</span>
<span class="hl std">myColumns</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">colnames</span><span class="hl std">(df_dados)</span>
<span class="hl std">myColumns</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;Car full name&quot;                          &quot;Make&quot;                                  
##  [3] &quot;Model&quot;                                  &quot;Minimal price (gross) [PLN]&quot;           
##  [5] &quot;Engine power [KM]&quot;                      &quot;Maximum torque [Nm]&quot;                   
##  [7] &quot;Type of brakes&quot;                         &quot;Drive type&quot;                            
##  [9] &quot;Battery capacity [kWh]&quot;                 &quot;Range (WLTP) [km]&quot;                     
## [11] &quot;Wheelbase [cm]&quot;                         &quot;Length [cm]&quot;                           
## [13] &quot;Width [cm]&quot;                             &quot;Height [cm]&quot;                           
## [15] &quot;Minimal empty weight [kg]&quot;              &quot;Permissable gross weight [kg]&quot;         
## [17] &quot;Maximum load capacity [kg]&quot;             &quot;Number of seats&quot;                       
## [19] &quot;Number of doors&quot;                        &quot;Tire size [in]&quot;                        
## [21] &quot;Maximum speed [kph]&quot;                    &quot;Boot capacity (VDA) [l]&quot;               
## [23] &quot;Acceleration 0-100 kph [s]&quot;             &quot;Maximum DC charging power [kW]&quot;        
## [25] &quot;mean - Energy consumption [kWh/100 km]&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Vamos renomar as colunas para facilitar nosso trabalho mais tarde</span>
<span class="hl std">myColumns[</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;CarroNome&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">2</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Fabricante&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">3</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Modelo&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">4</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;PrecoMIn&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">5</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;MotorKM&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">6</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;TorqueMax&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">7</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;TiposFreios&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">8</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Cambio&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">9</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;CapacidadeBateria&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">10</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Autonomia&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">11</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;DistanciaEixosCM&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">12</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;TamCM&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">13</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;LarguraCM&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">14</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;ComprimentoCM&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">15</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;PesoVazio&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">16</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;PesoMax&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">17</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;CapacidadeMaxima&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">18</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;NumBancos&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">19</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;NumPortas&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">20</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;TamPneu&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">21</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;VelocidadeMax&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">22</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;CapacidadeIni&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">23</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Acceleracao0100&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">24</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Torque&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">25</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;MediaConsumoEnergia&quot;</span>
<span class="hl std">myColumns[</span><span class="hl num">26</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span><span class="hl str">&quot;Make_fac&quot;</span>


<span class="hl com"># Verifica o resultado</span>
<span class="hl std">myColumns</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;CarroNome&quot;           &quot;Fabricante&quot;          &quot;Modelo&quot;             
##  [4] &quot;PrecoMIn&quot;            &quot;MotorKM&quot;             &quot;TorqueMax&quot;          
##  [7] &quot;TiposFreios&quot;         &quot;Cambio&quot;              &quot;CapacidadeBateria&quot;  
## [10] &quot;Autonomia&quot;           &quot;DistanciaEixosCM&quot;    &quot;TamCM&quot;              
## [13] &quot;LarguraCM&quot;           &quot;ComprimentoCM&quot;       &quot;PesoVazio&quot;          
## [16] &quot;PesoMax&quot;             &quot;CapacidadeMaxima&quot;    &quot;NumBancos&quot;          
## [19] &quot;NumPortas&quot;           &quot;TamPneu&quot;             &quot;VelocidadeMax&quot;      
## [22] &quot;CapacidadeIni&quot;       &quot;Acceleracao0100&quot;     &quot;Torque&quot;             
## [25] &quot;MediaConsumoEnergia&quot; &quot;Make_fac&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Atribui os novos nomes de colunas ao dataframe</span>
<span class="hl kwd">colnames</span><span class="hl std">(df_dados)</span> <span class="hl kwb">&lt;-</span> <span class="hl std">myColumns</span>
<span class="hl kwd">rm</span><span class="hl std">(myColumns)</span>
<span class="hl kwd">View</span><span class="hl std">(df_dados)</span>

<span class="hl com"># Verificando ocorrência de valores NA</span>
<span class="hl kwd">colSums</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(df_dados))</span>
</pre></div>
<div class="output"><pre class="knitr r">##           CarroNome          Fabricante              Modelo            PrecoMIn 
##                   0                   0                   0                   0 
##             MotorKM           TorqueMax         TiposFreios              Cambio 
##                   0                   0                   1                   0 
##   CapacidadeBateria           Autonomia    DistanciaEixosCM               TamCM 
##                   0                   0                   0                   0 
##           LarguraCM       ComprimentoCM           PesoVazio             PesoMax 
##                   0                   0                   0                   8 
##    CapacidadeMaxima           NumBancos           NumPortas             TamPneu 
##                   8                   0                   0                   0 
##       VelocidadeMax       CapacidadeIni     Acceleracao0100              Torque 
##                   0                   1                   3                   0 
## MediaConsumoEnergia 
##                   9
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(df_dados))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 30
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">any</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(df_dados))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] TRUE
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#df_dados &lt;- na.omit(df_dados)</span>
<span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(df_dados))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 30
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Quantas linhas tem casos completos?</span>
<span class="hl std">complete_cases</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">complete.cases</span><span class="hl std">(df_dados))</span>

<span class="hl com"># Quantas linhas tem casos incompletos?</span>
<span class="hl std">not_complete_cases</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl opt">!</span><span class="hl kwd">complete.cases</span><span class="hl std">(df_dados))</span>

<span class="hl com"># Qual o percentual de dados incompletos?</span>
<span class="hl std">percentual</span> <span class="hl kwb">&lt;-</span> <span class="hl std">(not_complete_cases</span> <span class="hl opt">/</span> <span class="hl std">complete_cases)</span> <span class="hl opt">*</span> <span class="hl num">100</span>
<span class="hl std">percentual</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 26.19048
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Remover NA</span>
<span class="hl std">df_dados</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">na.omit</span><span class="hl std">(df_dados)</span>

<span class="hl com"># Remove os objetos anteriores para liberar memória RAM</span>
<span class="hl kwd">rm</span><span class="hl std">(complete_cases)</span>
<span class="hl kwd">rm</span><span class="hl std">(not_complete_cases)</span>


<span class="hl com"># Nomes das colunas</span>
<span class="hl kwd">colnames</span><span class="hl std">(df_dados)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;CarroNome&quot;           &quot;Fabricante&quot;          &quot;Modelo&quot;             
##  [4] &quot;PrecoMIn&quot;            &quot;MotorKM&quot;             &quot;TorqueMax&quot;          
##  [7] &quot;TiposFreios&quot;         &quot;Cambio&quot;              &quot;CapacidadeBateria&quot;  
## [10] &quot;Autonomia&quot;           &quot;DistanciaEixosCM&quot;    &quot;TamCM&quot;              
## [13] &quot;LarguraCM&quot;           &quot;ComprimentoCM&quot;       &quot;PesoVazio&quot;          
## [16] &quot;PesoMax&quot;             &quot;CapacidadeMaxima&quot;    &quot;NumBancos&quot;          
## [19] &quot;NumPortas&quot;           &quot;TamPneu&quot;             &quot;VelocidadeMax&quot;      
## [22] &quot;CapacidadeIni&quot;       &quot;Acceleracao0100&quot;     &quot;Torque&quot;             
## [25] &quot;MediaConsumoEnergia&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Verificando os níveis do fator. Perceba que os níveis estão categorizados em ordem alfabética</span>
<span class="hl kwd">levels</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Fabricante)</span>
</pre></div>
<div class="output"><pre class="knitr r">## NULL
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Extraindo as variáveis numéricas</span>

<span class="hl std">numeric_vars</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sapply</span><span class="hl std">(df_dados, is.numeric)</span>
<span class="hl std">numeric_data</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados[, numeric_vars]</span>
<span class="hl kwd">str</span><span class="hl std">(numeric_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">## tibble [42 × 20] (S3: tbl_df/tbl/data.frame)
##  $ PrecoMIn           : num [1:42] 345700 308400 414900 319700 357000 ...
##  $ MotorKM            : num [1:42] 360 313 503 313 360 503 170 184 286 136 ...
##  $ TorqueMax          : num [1:42] 664 540 973 540 664 973 250 270 400 260 ...
##  $ CapacidadeBateria  : num [1:42] 95 71 95 71 95 95 42.2 42.2 80 50 ...
##  $ Autonomia          : num [1:42] 438 340 364 346 447 369 359 345 460 320 ...
##  $ DistanciaEixosCM   : num [1:42] 293 293 293 293 293 ...
##  $ TamCM              : num [1:42] 490 490 490 490 490 ...
##  $ LarguraCM          : num [1:42] 194 194 198 194 194 ...
##  $ ComprimentoCM      : num [1:42] 163 163 163 162 162 ...
##  $ PesoVazio          : num [1:42] 2565 2445 2695 2445 2595 ...
##  $ PesoMax            : num [1:42] 3130 3040 3130 3040 3130 ...
##  $ CapacidadeMaxima   : num [1:42] 640 670 565 640 670 565 440 440 540 450 ...
##  $ NumBancos          : num [1:42] 5 5 5 5 5 5 4 4 5 5 ...
##  $ NumPortas          : num [1:42] 5 5 5 5 5 5 5 5 5 5 ...
##  $ TamPneu            : num [1:42] 19 19 20 19 19 20 19 20 19 17 ...
##  $ VelocidadeMax      : num [1:42] 200 190 210 190 200 210 160 160 180 150 ...
##  $ CapacidadeIni      : num [1:42] 660 660 660 615 615 615 260 260 510 350 ...
##  $ Acceleracao0100    : num [1:42] 5.7 6.8 4.5 6.8 5.7 4.5 8.1 6.9 6.8 8.7 ...
##  $ Torque             : num [1:42] 150 150 150 150 150 150 50 50 150 100 ...
##  $ MediaConsumoEnergia: num [1:42] 24.4 23.8 27.6 23.3 23.9 ...
##  - attr(*, &quot;na.action&quot;)= 'omit' Named int [1:11] 10 30 40 41 42 43 44 45 46 52 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:11] &quot;10&quot; &quot;30&quot; &quot;40&quot; &quot;41&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Extraindo as variáveis  categóricas</span>
<span class="hl std">categorical_vars</span> <span class="hl kwb">&lt;-</span> <span class="hl opt">!</span><span class="hl std">numeric_vars</span>
<span class="hl std">categorical_data</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados[, categorical_vars]</span>
<span class="hl kwd">str</span><span class="hl std">(categorical_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">## tibble [42 × 5] (S3: tbl_df/tbl/data.frame)
##  $ CarroNome  : chr [1:42] &quot;Audi e-tron 55 quattro&quot; &quot;Audi e-tron 50 quattro&quot; &quot;Audi e-tron S quattro&quot; &quot;Audi e-tron Sportback 50 quattro&quot; ...
##  $ Fabricante : chr [1:42] &quot;Audi&quot; &quot;Audi&quot; &quot;Audi&quot; &quot;Audi&quot; ...
##  $ Modelo     : chr [1:42] &quot;e-tron 55 quattro&quot; &quot;e-tron 50 quattro&quot; &quot;e-tron S quattro&quot; &quot;e-tron Sportback 50 quattro&quot; ...
##  $ TiposFreios: chr [1:42] &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; ...
##  $ Cambio     : chr [1:42] &quot;4WD&quot; &quot;4WD&quot; &quot;4WD&quot; &quot;4WD&quot; ...
##  - attr(*, &quot;na.action&quot;)= 'omit' Named int [1:11] 10 30 40 41 42 43 44 45 46 52 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:11] &quot;10&quot; &quot;30&quot; &quot;40&quot; &quot;41&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Medindo as amplitudes-----------------------------</span>
<span class="hl kwd">summary</span><span class="hl std">(numeric_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">##     PrecoMIn         MotorKM        TorqueMax      CapacidadeBateria   Autonomia    
##  Min.   : 82050   Min.   : 82.0   Min.   : 160.0   Min.   :17.60     Min.   :148.0  
##  1st Qu.:140650   1st Qu.:136.0   1st Qu.: 260.0   1st Qu.:39.20     1st Qu.:279.2  
##  Median :166945   Median :184.0   Median : 317.5   Median :52.00     Median :352.5  
##  Mean   :235066   Mean   :237.7   Mean   : 425.2   Mean   :58.84     Mean   :351.7  
##  3rd Qu.:316875   3rd Qu.:313.0   3rd Qu.: 540.0   3rd Qu.:78.65     3rd Qu.:434.8  
##  Max.   :794000   Max.   :625.0   Max.   :1050.0   Max.   :95.00     Max.   :549.0  
##  DistanciaEixosCM     TamCM         LarguraCM     ComprimentoCM     PesoVazio   
##  Min.   :187.3    Min.   :269.5   Min.   :164.5   Min.   :137.8   Min.   :1035  
##  1st Qu.:256.3    1st Qu.:406.6   1st Qu.:178.7   1st Qu.:151.2   1st Qu.:1516  
##  Median :270.0    Median :431.8   Median :180.2   Median :156.0   Median :1622  
##  Mean   :269.8    Mean   :433.5   Mean   :184.8   Mean   :155.0   Mean   :1821  
##  3rd Qu.:290.0    3rd Qu.:475.5   3rd Qu.:193.5   3rd Qu.:160.5   3rd Qu.:2249  
##  Max.   :327.5    Max.   :496.3   Max.   :255.8   Max.   :190.0   Max.   :2695  
##     PesoMax     CapacidadeMaxima   NumBancos       NumPortas       TamPneu     
##  Min.   :1310   Min.   : 290.0   Min.   :2.000   Min.   :3.00   Min.   :14.00  
##  1st Qu.:1882   1st Qu.: 440.0   1st Qu.:4.250   1st Qu.:5.00   1st Qu.:16.00  
##  Median :2100   Median : 485.5   Median :5.000   Median :5.00   Median :17.00  
##  Mean   :2268   Mean   : 510.5   Mean   :4.762   Mean   :4.81   Mean   :17.55  
##  3rd Qu.:2855   3rd Qu.: 565.0   3rd Qu.:5.000   3rd Qu.:5.00   3rd Qu.:19.00  
##  Max.   :3130   Max.   :1056.0   Max.   :8.000   Max.   :5.00   Max.   :21.00  
##  VelocidadeMax   CapacidadeIni   Acceleracao0100      Torque      MediaConsumoEnergia
##  Min.   :130.0   Min.   :171.0   Min.   : 2.800   Min.   : 22.0   Min.   :13.10      
##  1st Qu.:146.2   1st Qu.:310.2   1st Qu.: 6.800   1st Qu.: 62.5   1st Qu.:15.60      
##  Median :160.0   Median :371.0   Median : 7.900   Median :100.0   Median :16.88      
##  Mean   :169.5   Mean   :404.3   Mean   : 7.893   Mean   :109.7   Mean   :18.61      
##  3rd Qu.:187.5   3rd Qu.:497.0   3rd Qu.: 9.650   3rd Qu.:143.8   3rd Qu.:22.94      
##  Max.   :260.0   Max.   :660.0   Max.   :13.100   Max.   :270.0   Max.   :27.55
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Variável dependente Target MediaConsumoEnergia</span>
<span class="hl kwd">range</span><span class="hl std">(numeric_data</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 13.10 27.55
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Ramge Min Consumo 13.10km  27.55km</span>

<span class="hl kwd">mean</span><span class="hl std">(numeric_data</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 18.61071
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># média 18.61071</span>

<span class="hl kwd">median</span><span class="hl std">(numeric_data</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 16.875
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Mediana 16.875</span>

<span class="hl kwd">sd</span><span class="hl std">(numeric_data</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 4.134293
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Desviio Padrão 4.134293</span>

<span class="hl kwd">var</span><span class="hl std">(numeric_data</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 17.09238
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Variancia 17.09238</span>


<span class="hl com"># Média de Autonomia 351.7381 KM</span>
<span class="hl kwd">mean</span><span class="hl std">(numeric_data</span><span class="hl opt">$</span><span class="hl std">Autonomia)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 351.7381
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Média de Preço é 235065.8 235.000 </span>
<span class="hl kwd">mean</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">PrecoMIn)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 235065.8
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Mediana Preço Min 166.945</span>
<span class="hl kwd">median</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">PrecoMIn)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 166945
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Min e Max PreçoMIn 82050 794000</span>
<span class="hl kwd">range</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">PrecoMIn)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1]  82050 794000
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Convert Campos Fator </span>
<span class="hl std">df_dados</span><span class="hl opt">$</span><span class="hl std">Fabricante</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.factor</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Fabricante)</span>
<span class="hl kwd">levels</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Fabricante)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;Audi&quot;          &quot;BMW&quot;           &quot;Citroën&quot;       &quot;DS&quot;            &quot;Honda&quot;        
##  [6] &quot;Hyundai&quot;       &quot;Jaguar&quot;        &quot;Kia&quot;           &quot;Mazda&quot;         &quot;Mercedes-Benz&quot;
## [11] &quot;Mini&quot;          &quot;Nissan&quot;        &quot;Opel&quot;          &quot;Peugeot&quot;       &quot;Porsche&quot;      
## [16] &quot;Renault&quot;       &quot;Skoda&quot;         &quot;Smart&quot;         &quot;Volkswagen&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">summary</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Fabricante)</span>
</pre></div>
<div class="output"><pre class="knitr r">##          Audi           BMW       Citroën            DS         Honda       Hyundai 
##             6             3             1             1             2             3 
##        Jaguar           Kia         Mazda Mercedes-Benz          Mini        Nissan 
##             1             4             1             1             1             2 
##          Opel       Peugeot       Porsche       Renault         Skoda         Smart 
##             2             1             4             2             1             2 
##    Volkswagen 
##             4
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">df_dados</span><span class="hl opt">$</span><span class="hl std">Modelo</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.factor</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Modelo)</span>
<span class="hl kwd">levels</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Modelo)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;Citigo-e iV&quot;                  &quot;Cooper SE&quot;                   
##  [3] &quot;Corsa-e&quot;                      &quot;DS3 Crossback e-tense&quot;       
##  [5] &quot;e&quot;                            &quot;e-208&quot;                       
##  [7] &quot;e-Niro 39.2kWh&quot;               &quot;e-Niro 64kWh&quot;                
##  [9] &quot;e-Soul 39.2kWh&quot;               &quot;e-Soul 64kWh&quot;                
## [11] &quot;ë-Spacetourer (M)&quot;            &quot;e-tron 50 quattro&quot;           
## [13] &quot;e-tron 55 quattro&quot;            &quot;e-tron S quattro&quot;            
## [15] &quot;e-tron Sportback 50 quattro&quot;  &quot;e-tron Sportback 55 quattro&quot; 
## [17] &quot;e-tron Sportback S quattro&quot;   &quot;e-up!&quot;                       
## [19] &quot;e Advance&quot;                    &quot;EQC&quot;                         
## [21] &quot;forfour EQ&quot;                   &quot;fortwo EQ&quot;                   
## [23] &quot;I-Pace&quot;                       &quot;i3&quot;                          
## [25] &quot;i3s&quot;                          &quot;ID.3 Pro Performance&quot;        
## [27] &quot;ID.3 Pro S&quot;                   &quot;ID.4 1st&quot;                    
## [29] &quot;Ioniq electric&quot;               &quot;iX3&quot;                         
## [31] &quot;Kona electric 39.2kWh&quot;        &quot;Kona electric 64kWh&quot;         
## [33] &quot;Leaf&quot;                         &quot;Leaf e+&quot;                     
## [35] &quot;Mokka-e&quot;                      &quot;MX-30&quot;                       
## [37] &quot;Taycan 4S (Performance Plus)&quot; &quot;Taycan 4S (Performance)&quot;     
## [39] &quot;Taycan Turbo&quot;                 &quot;Taycan Turbo S&quot;              
## [41] &quot;Zoe R110&quot;                     &quot;Zoe R135&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">summary</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">Modelo)</span>
</pre></div>
<div class="output"><pre class="knitr r">##                  Citigo-e iV                    Cooper SE                      Corsa-e 
##                            1                            1                            1 
##        DS3 Crossback e-tense                            e                        e-208 
##                            1                            1                            1 
##               e-Niro 39.2kWh                 e-Niro 64kWh               e-Soul 39.2kWh 
##                            1                            1                            1 
##                 e-Soul 64kWh            ë-Spacetourer (M)            e-tron 50 quattro 
##                            1                            1                            1 
##            e-tron 55 quattro             e-tron S quattro  e-tron Sportback 50 quattro 
##                            1                            1                            1 
##  e-tron Sportback 55 quattro   e-tron Sportback S quattro                        e-up! 
##                            1                            1                            1 
##                    e Advance                          EQC                   forfour EQ 
##                            1                            1                            1 
##                    fortwo EQ                       I-Pace                           i3 
##                            1                            1                            1 
##                          i3s         ID.3 Pro Performance                   ID.3 Pro S 
##                            1                            1                            1 
##                     ID.4 1st               Ioniq electric                          iX3 
##                            1                            1                            1 
##        Kona electric 39.2kWh          Kona electric 64kWh                         Leaf 
##                            1                            1                            1 
##                      Leaf e+                      Mokka-e                        MX-30 
##                            1                            1                            1 
## Taycan 4S (Performance Plus)      Taycan 4S (Performance)                 Taycan Turbo 
##                            1                            1                            1 
##               Taycan Turbo S                     Zoe R110                     Zoe R135 
##                            1                            1                            1
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Variáveis e tipos de dados</span>
<span class="hl kwd">str</span><span class="hl std">(df_dados)</span>
</pre></div>
<div class="output"><pre class="knitr r">## tibble [42 × 25] (S3: tbl_df/tbl/data.frame)
##  $ CarroNome          : chr [1:42] &quot;Audi e-tron 55 quattro&quot; &quot;Audi e-tron 50 quattro&quot; &quot;Audi e-tron S quattro&quot; &quot;Audi e-tron Sportback 50 quattro&quot; ...
##  $ Fabricante         : Factor w/ 19 levels &quot;Audi&quot;,&quot;BMW&quot;,&quot;Citroën&quot;,..: 1 1 1 1 1 1 2 2 2 4 ...
##  $ Modelo             : Factor w/ 42 levels &quot;Citigo-e iV&quot;,..: 13 12 14 15 16 17 24 25 30 4 ...
##  $ PrecoMIn           : num [1:42] 345700 308400 414900 319700 357000 ...
##  $ MotorKM            : num [1:42] 360 313 503 313 360 503 170 184 286 136 ...
##  $ TorqueMax          : num [1:42] 664 540 973 540 664 973 250 270 400 260 ...
##  $ TiposFreios        : chr [1:42] &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; &quot;disc (front + rear)&quot; ...
##  $ Cambio             : chr [1:42] &quot;4WD&quot; &quot;4WD&quot; &quot;4WD&quot; &quot;4WD&quot; ...
##  $ CapacidadeBateria  : num [1:42] 95 71 95 71 95 95 42.2 42.2 80 50 ...
##  $ Autonomia          : num [1:42] 438 340 364 346 447 369 359 345 460 320 ...
##  $ DistanciaEixosCM   : num [1:42] 293 293 293 293 293 ...
##  $ TamCM              : num [1:42] 490 490 490 490 490 ...
##  $ LarguraCM          : num [1:42] 194 194 198 194 194 ...
##  $ ComprimentoCM      : num [1:42] 163 163 163 162 162 ...
##  $ PesoVazio          : num [1:42] 2565 2445 2695 2445 2595 ...
##  $ PesoMax            : num [1:42] 3130 3040 3130 3040 3130 ...
##  $ CapacidadeMaxima   : num [1:42] 640 670 565 640 670 565 440 440 540 450 ...
##  $ NumBancos          : num [1:42] 5 5 5 5 5 5 4 4 5 5 ...
##  $ NumPortas          : num [1:42] 5 5 5 5 5 5 5 5 5 5 ...
##  $ TamPneu            : num [1:42] 19 19 20 19 19 20 19 20 19 17 ...
##  $ VelocidadeMax      : num [1:42] 200 190 210 190 200 210 160 160 180 150 ...
##  $ CapacidadeIni      : num [1:42] 660 660 660 615 615 615 260 260 510 350 ...
##  $ Acceleracao0100    : num [1:42] 5.7 6.8 4.5 6.8 5.7 4.5 8.1 6.9 6.8 8.7 ...
##  $ Torque             : num [1:42] 150 150 150 150 150 150 50 50 150 100 ...
##  $ MediaConsumoEnergia: num [1:42] 24.4 23.8 27.6 23.3 23.9 ...
##  - attr(*, &quot;na.action&quot;)= 'omit' Named int [1:11] 10 30 40 41 42 43 44 45 46 52 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:11] &quot;10&quot; &quot;30&quot; &quot;40&quot; &quot;41&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Matriz de Correlação</span>
<span class="hl kwd">cor</span><span class="hl std">(numeric_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">##                        PrecoMIn     MotorKM    TorqueMax CapacidadeBateria  Autonomia
## PrecoMIn             1.00000000  0.96090955  0.902694431        0.79408068  0.4577102
## MotorKM              0.96090955  1.00000000  0.952062140        0.86852061  0.5370076
## TorqueMax            0.90269443  0.95206214  1.000000000        0.83189441  0.4503051
## CapacidadeBateria    0.79408068  0.86852061  0.831894406        1.00000000  0.8092553
## Autonomia            0.45771017  0.53700763  0.450305128        0.80925526  1.0000000
## DistanciaEixosCM     0.62435370  0.64498383  0.635060942        0.74460203  0.5075445
## TamCM                0.73475225  0.77315650  0.760928943        0.84183683  0.6044038
## LarguraCM            0.47621771  0.47187218  0.457055008        0.52470674  0.3366901
## ComprimentoCM       -0.23587726 -0.19381690 -0.092389876        0.04163423 -0.0112427
## PesoVazio            0.78670749  0.85533411  0.858799330        0.92096505  0.5913838
## PesoMax              0.76776036  0.81507279  0.803782763        0.88501111  0.5497372
## CapacidadeMaxima     0.47506858  0.43270799  0.390599129        0.50753901  0.2736420
## NumBancos           -0.09068844 -0.08745365 -0.001363035        0.16724829  0.1305064
## NumPortas           -0.30669290 -0.26089020 -0.133803691        0.03800588  0.1525001
## TamPneu              0.75024149  0.80097775  0.749802241        0.78821091  0.6188445
## VelocidadeMax        0.94381157  0.95168277  0.877643876        0.82387115  0.5611077
## CapacidadeIni        0.57594755  0.64427362  0.676182162        0.79423877  0.5088502
## Acceleracao0100     -0.81099044 -0.89669357 -0.832416924       -0.81940251 -0.6276312
## Torque               0.88771930  0.85407706  0.770809047        0.78890175  0.5512162
## MediaConsumoEnergia  0.79944742  0.82464843  0.827639009        0.75786574  0.2744891
##                     DistanciaEixosCM      TamCM   LarguraCM ComprimentoCM   PesoVazio
## PrecoMIn                   0.6243537  0.7347522  0.47621771   -0.23587726  0.78670749
## MotorKM                    0.6449838  0.7731565  0.47187218   -0.19381690  0.85533411
## TorqueMax                  0.6350609  0.7609289  0.45705501   -0.09238988  0.85879933
## CapacidadeBateria          0.7446020  0.8418368  0.52470674    0.04163423  0.92096505
## Autonomia                  0.5075445  0.6044038  0.33669012   -0.01124270  0.59138380
## DistanciaEixosCM           1.0000000  0.9137165  0.48806451    0.32845344  0.82807346
## TamCM                      0.9137165  1.0000000  0.54354711    0.10114942  0.89643525
## LarguraCM                  0.4880645  0.5435471  1.00000000    0.07603541  0.52459686
## ComprimentoCM              0.3284534  0.1011494  0.07603541    1.00000000  0.20215504
## PesoVazio                  0.8280735  0.8964352  0.52459686    0.20215504  1.00000000
## PesoMax                    0.8679398  0.9058960  0.53667898    0.21625601  0.97972500
## CapacidadeMaxima           0.8105733  0.6770901  0.40205020    0.41431910  0.61316189
## NumBancos                  0.6256672  0.4172107  0.23262103    0.61912209  0.26314414
## NumPortas                  0.2646807  0.1712633  0.04435635    0.46312924  0.06579237
## TamPneu                    0.6433391  0.7467170  0.50014251    0.06801116  0.80848609
## VelocidadeMax              0.5959374  0.7636150  0.47471759   -0.33049793  0.78021624
## CapacidadeIni              0.8442445  0.8418493  0.51408200    0.40282847  0.88201835
## Acceleracao0100           -0.5372283 -0.7348261 -0.46355915    0.30330802 -0.76406884
## Torque                     0.6274435  0.7633754  0.49159807   -0.28568743  0.75193494
## MediaConsumoEnergia        0.7164781  0.7210755  0.44686912    0.13285838  0.86190952
##                         PesoMax CapacidadeMaxima    NumBancos    NumPortas     TamPneu
## PrecoMIn             0.76776036      0.475068582 -0.090688436 -0.306692899  0.75024149
## MotorKM              0.81507279      0.432707985 -0.087453650 -0.260890205  0.80097775
## TorqueMax            0.80378276      0.390599129 -0.001363035 -0.133803691  0.74980224
## CapacidadeBateria    0.88501111      0.507539014  0.167248289  0.038005880  0.78821091
## Autonomia            0.54973719      0.273642010  0.130506408  0.152500139  0.61884454
## DistanciaEixosCM     0.86793980      0.810573337  0.625667199  0.264680729  0.64333906
## TamCM                0.90589604      0.677090091  0.417210653  0.171263315  0.74671705
## LarguraCM            0.53667898      0.402050200  0.232621034  0.044356345  0.50014251
## ComprimentoCM        0.21625601      0.414319101  0.619122086  0.463129238  0.06801116
## PesoVazio            0.97972500      0.613161895  0.263144144  0.065792365  0.80848609
## PesoMax              1.00000000      0.709318405  0.329616122  0.041930925  0.74973766
## CapacidadeMaxima     0.70931840      1.000000000  0.536034513 -0.002314982  0.41987402
## NumBancos            0.32961612      0.536034513  1.000000000  0.616216585  0.02479051
## NumPortas            0.04193092     -0.002314982  0.616216585  1.000000000 -0.01625724
## TamPneu              0.74973766      0.419874021  0.024790506 -0.016257241  1.00000000
## VelocidadeMax        0.75049975      0.447107139 -0.160005945 -0.302964824  0.76933570
## CapacidadeIni        0.90614041      0.728206393  0.407679455  0.188547338  0.63945261
## Acceleracao0100     -0.70482336     -0.255273354  0.122769541  0.212901102 -0.82744844
## Torque               0.74551349      0.509866271  0.021871644 -0.236286284  0.67054887
## MediaConsumoEnergia  0.87477101      0.650026546  0.183648113 -0.172312792  0.57797942
##                     VelocidadeMax CapacidadeIni Acceleracao0100      Torque
## PrecoMIn                0.9438116     0.5759475      -0.8109904  0.88771930
## MotorKM                 0.9516828     0.6442736      -0.8966936  0.85407706
## TorqueMax               0.8776439     0.6761822      -0.8324169  0.77080905
## CapacidadeBateria       0.8238711     0.7942388      -0.8194025  0.78890175
## Autonomia               0.5611077     0.5088502      -0.6276312  0.55121621
## DistanciaEixosCM        0.5959374     0.8442445      -0.5372283  0.62744351
## TamCM                   0.7636150     0.8418493      -0.7348261  0.76337541
## LarguraCM               0.4747176     0.5140820      -0.4635592  0.49159807
## ComprimentoCM          -0.3304979     0.4028285       0.3033080 -0.28568743
## PesoVazio               0.7802162     0.8820183      -0.7640688  0.75193494
## PesoMax                 0.7504997     0.9061404      -0.7048234  0.74551349
## CapacidadeMaxima        0.4471071     0.7282064      -0.2552734  0.50986627
## NumBancos              -0.1600059     0.4076795       0.1227695  0.02187164
## NumPortas              -0.3029648     0.1885473       0.2129011 -0.23628628
## TamPneu                 0.7693357     0.6394526      -0.8274484  0.67054887
## VelocidadeMax           1.0000000     0.5758061      -0.8870691  0.92097511
## CapacidadeIni           0.5758061     1.0000000      -0.5249693  0.53458220
## Acceleracao0100        -0.8870691    -0.5249693       1.0000000 -0.77270571
## Torque                  0.9209751     0.5345822      -0.7727057  1.00000000
## MediaConsumoEnergia     0.7304696     0.7721157      -0.6268448  0.70932838
##                     MediaConsumoEnergia
## PrecoMIn                      0.7994474
## MotorKM                       0.8246484
## TorqueMax                     0.8276390
## CapacidadeBateria             0.7578657
## Autonomia                     0.2744891
## DistanciaEixosCM              0.7164781
## TamCM                         0.7210755
## LarguraCM                     0.4468691
## ComprimentoCM                 0.1328584
## PesoVazio                     0.8619095
## PesoMax                       0.8747710
## CapacidadeMaxima              0.6500265
## NumBancos                     0.1836481
## NumPortas                    -0.1723128
## TamPneu                       0.5779794
## VelocidadeMax                 0.7304696
## CapacidadeIni                 0.7721157
## Acceleracao0100              -0.6268448
## Torque                        0.7093284
## MediaConsumoEnergia           1.0000000
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Não foram encontrado valores outliers</span>

<span class="hl com"># Visualizando os dados</span>


<span class="hl kwd">quantile</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
<div class="output"><pre class="knitr r">##      0%     25%     50%     75%    100% 
## 13.1000 15.6000 16.8750 22.9375 27.5500
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#13.1000 15.6000 16.8750 22.9375 27.5500</span>

<span class="hl com"># Fabricante</span>
<span class="hl com"># Audi , Kia, Porche e Volksvagen possui mais carros eletricos</span>
<span class="hl std">gbar</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(df_dados,</span> <span class="hl kwd">aes</span><span class="hl std">(Fabricante))</span>
<span class="hl std">gbar</span> <span class="hl opt">+</span> <span class="hl kwd">geom_bar</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Histograma consumos energéticos dos carro</span>
<span class="hl com"># Percebe-se que o pico fica em 16, 17 na média de consumo </span>
<span class="hl kwd">hist</span><span class="hl std">(df_dados</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-2.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># MediaConsumoEnergia</span>
<span class="hl std">gboxplot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(df_dados,</span> <span class="hl kwd">aes</span><span class="hl std">(MediaConsumoEnergia))</span>
<span class="hl std">gboxplot</span> <span class="hl opt">+</span> <span class="hl kwd">geom_boxplot</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-3.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">#  MediaConsumoEnergia X Capacidade Bateria</span>
<span class="hl std">ConsumoXBateria</span> <span class="hl kwb">=</span> <span class="hl kwd">boxplot</span><span class="hl std">(</span><span class="hl kwc">data</span> <span class="hl std">= df_dados, MediaConsumoEnergia</span> <span class="hl opt">~</span> <span class="hl std">CapacidadeBateria,</span>
                       <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;MediaConsumoEnergia X Capacidade Bateria&quot;</span><span class="hl std">,</span>
                       <span class="hl kwc">col.main</span> <span class="hl std">=</span> <span class="hl str">&quot;red&quot;</span><span class="hl std">,</span> <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;MediaConsumoEnergia&quot;</span><span class="hl std">,</span> <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;capacidadeBateria&quot;</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-4.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">#  Capacidade Bateria X Autonomia X Fabricante</span>
<span class="hl com"># Audi, BMW, Citroen, DS, Honda e Hynday são os fabricantes que mais tem autonomia de uso acima de 400KM</span>
<span class="hl kwd">ggplot</span><span class="hl std">(df_dados,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= CapacidadeBateria,</span> <span class="hl kwc">y</span> <span class="hl std">= Autonomia,</span> <span class="hl kwc">colour</span> <span class="hl std">= Fabricante))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_point</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-5.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Capacidade de Bateria X Autonomia </span>
<span class="hl com"># Quanto maior a capacidade de bateria maior a autonomia</span>
<span class="hl kwd">ggplot</span><span class="hl std">(df_dados,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= CapacidadeBateria,</span> <span class="hl kwc">y</span> <span class="hl std">= Autonomia,</span> <span class="hl kwc">colour</span> <span class="hl std">= Modelo))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_point</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-6.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Maior parte dos veículos tem autonomia acima de 200 Km e  50O KM , </span>
<span class="hl com"># custam até 400.000</span>
<span class="hl kwd">ggplot</span><span class="hl std">(df_dados,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= PrecoMIn,</span> <span class="hl kwc">y</span> <span class="hl std">= Autonomia,</span> <span class="hl kwc">colour</span> <span class="hl std">= Modelo))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_point</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-7.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Agrupando os dados e calculando média  Energy consumption [kWh/100 km] </span>

<span class="hl com"># group_by()</span>
<span class="hl std">df_dados</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(Modelo)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">summarise</span><span class="hl std">(</span><span class="hl kwc">avg_MediaConsumoEnergia</span> <span class="hl std">=</span> <span class="hl kwd">mean</span><span class="hl std">(MediaConsumoEnergia),</span>
            <span class="hl kwc">min_MediaConsumoEnergia</span> <span class="hl std">=</span> <span class="hl kwd">min</span><span class="hl std">(MediaConsumoEnergia),</span>
            <span class="hl kwc">max_MediaConsumoEnergia</span> <span class="hl std">=</span> <span class="hl kwd">max</span><span class="hl std">(MediaConsumoEnergia),</span>
            <span class="hl kwc">total</span> <span class="hl std">=</span> <span class="hl kwd">n</span><span class="hl std">())</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 42 × 5
##    Modelo       avg_MediaConsumoEner…¹ min_MediaConsumoEner…² max_MediaConsumoEner…³ total
##    &lt;fct&gt;                         &lt;dbl&gt;                  &lt;dbl&gt;                  &lt;dbl&gt; &lt;int&gt;
##  1 Citigo-e iV                    15.4                   15.4                   15.4     1
##  2 Cooper SE                      16.8                   16.8                   16.8     1
##  3 Corsa-e                        16.6                   16.6                   16.6     1
##  4 DS3 Crossba…                   15.6                   15.6                   15.6     1
##  5 e                              17.2                   17.2                   17.2     1
##  6 e-208                          16.4                   16.4                   16.4     1
##  7 e-Niro 39.2…                   15.3                   15.3                   15.3     1
##  8 e-Niro 64kWh                   15.9                   15.9                   15.9     1
##  9 e-Soul 39.2…                   15.6                   15.6                   15.6     1
## 10 e-Soul 64kWh                   15.7                   15.7                   15.7     1
## # ℹ 32 more rows
## # ℹ abbreviated names: ¹​avg_MediaConsumoEnergia, ²​min_MediaConsumoEnergia,
## #   ³​max_MediaConsumoEnergia
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Carros Unicos</span>
<span class="hl std">carros</span> <span class="hl kwb">=</span> <span class="hl std">df_dados</span><span class="hl opt">$</span><span class="hl std">CarroNome</span>
<span class="hl kwd">unique</span><span class="hl std">(carros)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;Audi e-tron 55 quattro&quot;               &quot;Audi e-tron 50 quattro&quot;              
##  [3] &quot;Audi e-tron S quattro&quot;                &quot;Audi e-tron Sportback 50 quattro&quot;    
##  [5] &quot;Audi e-tron Sportback 55 quattro&quot;     &quot;Audi e-tron Sportback S quattro&quot;     
##  [7] &quot;BMW i3&quot;                               &quot;BMW i3s&quot;                             
##  [9] &quot;BMW iX3&quot;                              &quot;DS DS3 Crossback e-tense&quot;            
## [11] &quot;Honda e&quot;                              &quot;Honda e Advance&quot;                     
## [13] &quot;Hyundai Ioniq electric&quot;               &quot;Hyundai Kona electric 39.2kWh&quot;       
## [15] &quot;Hyundai Kona electric 64kWh&quot;          &quot;Jaguar I-Pace&quot;                       
## [17] &quot;Kia e-Niro 39.2kWh&quot;                   &quot;Kia e-Niro 64kWh&quot;                    
## [19] &quot;Kia e-Soul 39.2kWh&quot;                   &quot;Kia e-Soul 64kWh&quot;                    
## [21] &quot;Mazda MX-30&quot;                          &quot;Mercedes-Benz EQC&quot;                   
## [23] &quot;Mini Cooper SE&quot;                       &quot;Nissan Leaf&quot;                         
## [25] &quot;Nissan Leaf e+&quot;                       &quot;Opel Corsa-e&quot;                        
## [27] &quot;Opel Mokka-e&quot;                         &quot;Peugeot e-208&quot;                       
## [29] &quot;Porsche Taycan 4S (Performance)&quot;      &quot;Porsche Taycan 4S (Performance Plus)&quot;
## [31] &quot;Porsche Taycan Turbo&quot;                 &quot;Porsche Taycan Turbo S&quot;              
## [33] &quot;Renault Zoe R110&quot;                     &quot;Renault Zoe R135&quot;                    
## [35] &quot;Skoda Citigo-e iV&quot;                    &quot;Smart fortwo EQ&quot;                     
## [37] &quot;Smart forfour EQ&quot;                     &quot;Volkswagen e-up!&quot;                    
## [39] &quot;Volkswagen ID.3 Pro Performance&quot;      &quot;Volkswagen ID.3 Pro S&quot;               
## [41] &quot;Volkswagen ID.4 1st&quot;                  &quot;Citroën ë-Spacetourer (M)&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Modelos </span>
<span class="hl std">Fabricante</span> <span class="hl kwb">=</span> <span class="hl std">df_dados</span><span class="hl opt">$</span><span class="hl std">Fabricante</span>
<span class="hl kwd">unique</span><span class="hl std">(Fabricante)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] Audi          BMW           DS            Honda         Hyundai       Jaguar       
##  [7] Kia           Mazda         Mercedes-Benz Mini          Nissan        Opel         
## [13] Peugeot       Porsche       Renault       Skoda         Smart         Volkswagen   
## [19] Citroën      
## 19 Levels: Audi BMW Citroën DS Honda Hyundai Jaguar Kia Mazda Mercedes-Benz ... Volkswagen
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Carro mais economico</span>
<span class="hl std">Carro_min</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(Modelo)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">summarise</span><span class="hl std">(</span><span class="hl kwc">min_value</span> <span class="hl std">=</span> <span class="hl kwd">min</span><span class="hl std">(MediaConsumoEnergia))</span>


<span class="hl com"># Carro mais consumo </span>
<span class="hl std">Carro_max</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">group_by</span><span class="hl std">(Modelo)</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">summarise</span><span class="hl std">(</span><span class="hl kwc">max_value</span> <span class="hl std">=</span> <span class="hl kwd">max</span><span class="hl std">(MediaConsumoEnergia))</span>
<span class="hl std">Carro_max</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 42 × 2
##    Modelo                max_value
##    &lt;fct&gt;                     &lt;dbl&gt;
##  1 Citigo-e iV                15.4
##  2 Cooper SE                  16.8
##  3 Corsa-e                    16.6
##  4 DS3 Crossback e-tense      15.6
##  5 e                          17.2
##  6 e-208                      16.4
##  7 e-Niro 39.2kWh             15.3
##  8 e-Niro 64kWh               15.9
##  9 e-Soul 39.2kWh             15.6
## 10 e-Soul 64kWh               15.7
## # ℹ 32 more rows
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Consumo de MediaConsumoEnergia por Fabricante</span>
<span class="hl std">MediaConsumoEnergiaboxplot</span> <span class="hl kwb">=</span> <span class="hl kwd">boxplot</span><span class="hl std">(</span><span class="hl kwc">data</span> <span class="hl std">= df_dados, MediaConsumoEnergia</span>  <span class="hl opt">~</span> <span class="hl kwd">factor</span><span class="hl std">(Fabricante) ,</span>
                                     <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;MediaConsumoEnergia&quot;</span><span class="hl std">,</span>
                                     <span class="hl kwc">col.main</span> <span class="hl std">=</span> <span class="hl str">&quot;red&quot;</span><span class="hl std">,</span> <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;MediaConsumoEnergia&quot;</span><span class="hl std">,</span> <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Fabricante&quot;</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-8-8.png" alt="plot of chunk unnamed-chunk-8" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># randomForest para encontrar as variáveis mais relevantes</span>
<span class="hl std">regressor</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">randomForest</span><span class="hl std">( MediaConsumoEnergia</span> <span class="hl opt">~</span> <span class="hl std">. ,</span> <span class="hl kwc">data</span> <span class="hl std">= numeric_data,</span> <span class="hl kwc">importance</span><span class="hl std">=</span><span class="hl num">TRUE</span><span class="hl std">)</span> <span class="hl com"># fit the random forest with default parameter</span>
<span class="hl std">caret</span><span class="hl opt">::</span><span class="hl kwd">varImp</span><span class="hl std">(regressor)</span>
</pre></div>
<div class="output"><pre class="knitr r">##                      Overall
## PrecoMIn           8.5310570
## MotorKM            6.2691772
## TorqueMax          6.1692185
## CapacidadeBateria  3.7159765
## Autonomia          2.9653000
## DistanciaEixosCM  10.7768789
## TamCM              9.0917238
## LarguraCM          6.5385554
## ComprimentoCM      3.5049940
## PesoVazio          6.4476548
## PesoMax            9.5449487
## CapacidadeMaxima   7.4646934
## NumBancos          1.9432775
## NumPortas          0.9771323
## TamPneu            4.8192260
## VelocidadeMax      4.5713302
## CapacidadeIni      2.7781321
## Acceleracao0100    2.6663619
## Torque             4.2191512
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Depois de executar o Randomforest, encontramos as variaveis mais relevantes a variaval target</span>
<span class="hl com">##################################  OverallPrecoMIn    7.503244</span>
<span class="hl com">#MotorKM            4.976540</span>
<span class="hl com">#TorqueMax          5.546578</span>
<span class="hl com">#CapacidadeBateria  4.319913</span>
<span class="hl com">#Autonomia          2.743444</span>
<span class="hl com">##################################  DistanciaEixosCM  10.847786</span>
<span class="hl com">##################################  TamCM              8.913345</span>
<span class="hl com">##################################  LarguraCM          5.956610</span>
<span class="hl com">#ComprimentoCM      1.857416</span>
<span class="hl com">##################################  PesoVazio          6.816251</span>
<span class="hl com">##################################  PesoMax            9.963957</span>
<span class="hl com">##################################  CapacidadeMaxima   6.496824</span>
<span class="hl com">#NumBancos          2.702918</span>
<span class="hl com">#NumPortas         -1.246418</span>
<span class="hl com">##################################  TamPneu            5.077130</span>
<span class="hl com">#VelocidadeMax      4.324391</span>
<span class="hl com">#CapacidadeIni      4.305913</span>
<span class="hl com">#Acceleracao0100    2.326368</span>
<span class="hl com">#Torque             2.838302</span>

<span class="hl com"># Seleciona Colunas</span>

<span class="hl std">df_dados_model</span> <span class="hl kwb">&lt;-</span> <span class="hl std">numeric_data</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">select</span><span class="hl std">( PrecoMIn, DistanciaEixosCM , DistanciaEixosCM,TamCM,LarguraCM,PesoVazio,PesoMax,CapacidadeMaxima,TamPneu, MediaConsumoEnergia)</span>

<span class="hl kwd">View</span><span class="hl std">(df_dados_model)</span>


<span class="hl com"># Normalizar Dados  </span>
<span class="hl std">normalizar</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
  <span class="hl std">(x</span> <span class="hl opt">-</span> <span class="hl kwd">min</span><span class="hl std">(x))</span> <span class="hl opt">/</span> <span class="hl std">(</span><span class="hl kwd">max</span><span class="hl std">(x)</span> <span class="hl opt">-</span> <span class="hl kwd">min</span><span class="hl std">(x))</span>
<span class="hl std">}</span>

<span class="hl std">df_dados_norm</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.data.frame</span><span class="hl std">(</span><span class="hl kwd">lapply</span><span class="hl std">(df_dados_model, normalizar))</span>

<span class="hl kwd">str</span><span class="hl std">(df_dados_norm)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	42 obs. of  9 variables:
##  $ PrecoMIn           : num  0.37 0.318 0.468 0.334 0.386 ...
##  $ DistanciaEixosCM   : num  0.752 0.752 0.752 0.752 0.752 ...
##  $ TamCM              : num  0.973 0.973 0.973 0.973 0.973 ...
##  $ LarguraCM          : num  0.318 0.318 0.363 0.318 0.318 ...
##  $ PesoVazio          : num  0.922 0.849 1 0.849 0.94 ...
##  $ PesoMax            : num  1 0.951 1 0.951 1 ...
##  $ CapacidadeMaxima   : num  0.457 0.496 0.359 0.457 0.496 ...
##  $ TamPneu            : num  0.714 0.714 0.857 0.714 0.714 ...
##  $ MediaConsumoEnergia: num  0.785 0.74 1 0.706 0.744 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">View</span><span class="hl std">(df_dados_norm)</span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##### Modelos  ##### </span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-10"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Modelo 1 </span>

<span class="hl com"># Treinos e Teste </span>
<span class="hl std">split</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">createDataPartition</span><span class="hl std">(</span><span class="hl kwc">y</span> <span class="hl std">= df_dados_model</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia,</span> <span class="hl kwc">p</span> <span class="hl std">=</span> <span class="hl num">0.7</span><span class="hl std">,</span> <span class="hl kwc">list</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>

<span class="hl com"># Split dados</span>
<span class="hl std">dados_treino</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados_model[split,]</span>
<span class="hl std">dados_teste</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados_model[</span><span class="hl opt">-</span><span class="hl std">split,]</span>

<span class="hl com"># Treino 1 modelo</span>
<span class="hl std">modelo_v1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(MediaConsumoEnergia</span> <span class="hl opt">~</span> <span class="hl std">.,</span> <span class="hl kwc">data</span> <span class="hl std">= dados_treino)</span>


<span class="hl com"># Summary 1 Modelo</span>
<span class="hl kwd">summary</span><span class="hl std">(modelo_v1)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = MediaConsumoEnergia ~ ., data = dados_treino)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.22703 -0.56524 -0.01436  0.69076  2.33629 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       1.989e+01  1.009e+01   1.971 0.061391 .  
## PrecoMIn          1.391e-05  2.552e-06   5.452 1.78e-05 ***
## DistanciaEixosCM  4.864e-02  5.564e-02   0.874 0.391450    
## TamCM            -2.900e-02  1.971e-02  -1.472 0.155252    
## LarguraCM        -2.484e-03  1.607e-02  -0.155 0.878560    
## PesoVazio         7.409e-03  3.441e-03   2.153 0.042526 *  
## PesoMax          -4.763e-04  2.831e-03  -0.168 0.867931    
## CapacidadeMaxima  4.719e-03  4.254e-03   1.109 0.279365    
## TamPneu          -1.108e+00  2.809e-01  -3.943 0.000693 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.212 on 22 degrees of freedom
## Multiple R-squared:  0.9254,	Adjusted R-squared:  0.8983 
## F-statistic: 34.11 on 8 and 22 DF,  p-value: 1.175e-10
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Plot Modelo 1</span>
<span class="hl kwd">plot</span><span class="hl std">(modelo_v1)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-1.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-2.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-3.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="warning"><pre class="knitr r">## Warning in sqrt(crit * p * (1 - hh)/hh): NaNs produced

## Warning in sqrt(crit * p * (1 - hh)/hh): NaNs produced
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-4.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">#colocar o gráfico de curcva de erro</span>

<span class="hl com"># Importancia de Variável </span>
<span class="hl com">#varimp(modelo_v1)</span>
<span class="hl std">vimp</span>  <span class="hl kwb">&lt;-</span> <span class="hl std">caret</span><span class="hl opt">::</span><span class="hl kwd">varImp</span><span class="hl std">(modelo_v1)</span>
<span class="hl kwd">plot</span><span class="hl std">(vimp)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-5.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">#PrecoMIn         3.54113987</span>
<span class="hl com">#DistanciaEixosCM 0.18599072</span>
<span class="hl com">#TamCM            1.37321574</span>
<span class="hl com">#LarguraCM        1.37760304</span>
<span class="hl com">#PesoVazio        1.68842605</span>
<span class="hl com">#PesoMax          0.13567274</span>
<span class="hl com">#CapacidadeMaxima 0.07599211</span>
<span class="hl com">#TamPneu          3.43723349</span>


<span class="hl com"># Primeiro modelo r-squared 0.92 92% e p-value de 2.472e-10 baixo. </span>
<span class="hl com"># O modelo 1 para esta com um bom desempenho de 92%</span>
<span class="hl com"># Variáveis mais relevantes são PrecoMIn,TamPneu, PesoVazio e LarguraCM</span>



<span class="hl com"># Previsoes</span>
<span class="hl opt">?</span><span class="hl std">predict</span>
<span class="hl std">predictedValues</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modelo_v1, dados_teste)</span>
<span class="hl std">predictedValues</span>
</pre></div>
<div class="output"><pre class="knitr r">##        1        2        3        4        5        6        7        8        9       10 
## 24.18573 24.34293 20.50590 17.27012 16.67354 16.19458 13.91686 16.81981 17.20177 17.86489 
##       11 
## 25.51123
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Calcula Acuracidade</span>
<span class="hl std">modelo_v1_mse</span>   <span class="hl kwb">&lt;-</span> <span class="hl kwd">MSE</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia, predictedValues)</span>
<span class="hl std">modelo_v1_rmse</span>  <span class="hl kwb">&lt;-</span> <span class="hl kwd">RMSE</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia,predictedValues)</span>
<span class="hl std">modelo_v1_mae</span>   <span class="hl kwb">&lt;-</span> <span class="hl kwd">MAE</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia, predictedValues)</span>
<span class="hl std">modelo_v1_r2</span>    <span class="hl kwb">&lt;-</span> <span class="hl kwd">R2</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia, predictedValues,</span> <span class="hl kwc">form</span> <span class="hl std">=</span> <span class="hl str">&quot;traditional&quot;</span><span class="hl std">)</span>

<span class="hl com">#model_desc         modelo_v1</span>
<span class="hl com">#1        MSE  2.29984730594314</span>
<span class="hl com">#2       RMSE    1.516524746235</span>
<span class="hl com">#3        MAE  1.14608042292544</span>
<span class="hl com">#4         R2 0.865442359399829</span>

<span class="hl com"># Plot Teste X Previsto</span>
<span class="hl kwd">ggplot</span><span class="hl std">(</span><span class="hl kwc">data</span> <span class="hl std">= dados_teste ,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= MediaConsumoEnergia ,</span> <span class="hl kwc">y</span> <span class="hl std">= predictedValues))</span> <span class="hl opt">+</span>
  <span class="hl kwd">ggtitle</span><span class="hl std">(</span><span class="hl str">&quot;Plot Comparativo  Teste X Previsto Modelo 1&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_point</span><span class="hl std">(</span><span class="hl kwc">shape</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_smooth</span><span class="hl std">(</span><span class="hl kwc">method</span> <span class="hl std">= lm ,</span> <span class="hl kwc">color</span> <span class="hl std">=</span> <span class="hl str">&quot;red&quot;</span><span class="hl std">,</span> <span class="hl kwc">se</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>  <span class="hl opt">+</span>
    <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">&quot;Valores Previstos&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span> <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">&quot;Dados Testes&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## `geom_smooth()` using formula = 'y ~ x'
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-6.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Modelo 2</span>

<span class="hl com"># Mostrando a importância das variáveis para a criação do modelo 1 </span>

<span class="hl com"># Seleciona Colunas Modelo 2 somente com as variávies com maior correlação do Modelo 1 </span>

<span class="hl std">df_dados_model2</span> <span class="hl kwb">&lt;-</span> <span class="hl std">numeric_data</span> <span class="hl opt">%&gt;%</span>
  <span class="hl kwd">select</span><span class="hl std">( PrecoMIn, TamCM, LarguraCM,PesoVazio,MediaConsumoEnergia)</span>

<span class="hl kwd">View</span><span class="hl std">(df_dados_model2)</span>

<span class="hl com"># Treinos e Teste </span>
<span class="hl std">split</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">createDataPartition</span><span class="hl std">(</span><span class="hl kwc">y</span> <span class="hl std">= df_dados_model2</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia,</span> <span class="hl kwc">p</span> <span class="hl std">=</span> <span class="hl num">0.7</span><span class="hl std">,</span> <span class="hl kwc">list</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>

<span class="hl com"># Split dados</span>
<span class="hl std">dados_treino</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados_model2[split,]</span>
<span class="hl std">dados_teste</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df_dados_model2[</span><span class="hl opt">-</span><span class="hl std">split,]</span>

<span class="hl com"># Treino 2 modelo</span>
<span class="hl std">modelo_v2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(MediaConsumoEnergia</span> <span class="hl opt">~</span> <span class="hl std">.,</span> <span class="hl kwc">data</span> <span class="hl std">= dados_treino)</span>


<span class="hl com"># Summary 2 Modelo</span>
<span class="hl kwd">summary</span><span class="hl std">(modelo_v2)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Call:
## lm(formula = MediaConsumoEnergia ~ ., data = dados_treino)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.2052 -1.1332  0.2498  1.1015  3.6526 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.641e+01  4.717e+00   3.479 0.001788 ** 
## PrecoMIn     1.103e-05  3.321e-06   3.321 0.002666 ** 
## TamCM       -2.970e-02  1.401e-02  -2.120 0.043689 *  
## LarguraCM   -7.608e-03  2.212e-02  -0.344 0.733643    
## PesoVazio    7.620e-03  1.680e-03   4.534 0.000115 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.728 on 26 degrees of freedom
## Multiple R-squared:  0.8462,	Adjusted R-squared:  0.8225 
## F-statistic: 35.76 on 4 and 26 DF,  p-value: 3.236e-10
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Plot Modelo 2</span>
<span class="hl kwd">plot</span><span class="hl std">(modelo_v2)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-7.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-8.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-9.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-10.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Importancia de Variável </span>
<span class="hl std">vimp</span>  <span class="hl kwb">&lt;-</span> <span class="hl std">caret</span><span class="hl opt">::</span><span class="hl kwd">varImp</span><span class="hl std">(modelo_v2)</span>
<span class="hl kwd">plot</span><span class="hl std">(vimp)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-11.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Segundo  modelo r-squared 0.40 92% e p-value de 2.472e-10 baixo. </span>
<span class="hl com"># O modelo 1 para esta com um bom desempenho de 40%</span>
<span class="hl com"># Variáveis mais relevantes são PrecoMIn,TamPneu, PesoVazio e LarguraCM</span>


<span class="hl com"># Previsoes</span>
<span class="hl opt">?</span><span class="hl std">predict</span>
<span class="hl std">predictedValues</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modelo_v2, dados_teste)</span>
<span class="hl std">predictedValues</span>
</pre></div>
<div class="output"><pre class="knitr r">##        1        2        3        4        5        6        7        8        9       10 
## 24.09767 15.99856 15.42475 17.43775 23.54133 16.51987 16.09373 16.44317 25.51660 15.86661 
##       11 
## 18.67425
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Calcula Acuracidade</span>
<span class="hl std">modelo_v2_mse</span>   <span class="hl kwb">&lt;-</span> <span class="hl kwd">MSE</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia, predictedValues)</span>
<span class="hl std">modelo_v2_rmse</span>   <span class="hl kwb">&lt;-</span> <span class="hl kwd">RMSE</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia,predictedValues)</span>
<span class="hl std">modelo_v2_mae</span>   <span class="hl kwb">&lt;-</span> <span class="hl kwd">MAE</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia, predictedValues)</span>
<span class="hl std">modelo_v2_r2</span>    <span class="hl kwb">&lt;-</span> <span class="hl kwd">R2</span><span class="hl std">(dados_teste</span><span class="hl opt">$</span><span class="hl std">MediaConsumoEnergia, predictedValues,</span> <span class="hl kwc">form</span> <span class="hl std">=</span> <span class="hl str">&quot;traditional&quot;</span><span class="hl std">)</span>

<span class="hl com">#model_desc         modelo_v2</span>
<span class="hl com">#1        MSE  2.74418698128479</span>
<span class="hl com">#2       RMSE  1.65655877688804</span>
<span class="hl com">#3        MAE  1.43847947829882</span>
<span class="hl com">#4         R2 0.743557215863707</span>

<span class="hl com"># Plot Teste X Previsto</span>
<span class="hl kwd">ggplot</span><span class="hl std">(</span><span class="hl kwc">data</span> <span class="hl std">= dados_teste ,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= MediaConsumoEnergia ,</span> <span class="hl kwc">y</span> <span class="hl std">= predictedValues))</span> <span class="hl opt">+</span>
  <span class="hl kwd">ggtitle</span><span class="hl std">(</span><span class="hl str">&quot;Plot Comparativo  Teste X Previsto Modelo 2&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_point</span><span class="hl std">(</span><span class="hl kwc">shape</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_smooth</span><span class="hl std">(</span><span class="hl kwc">method</span> <span class="hl std">= lm ,</span> <span class="hl kwc">color</span> <span class="hl std">=</span> <span class="hl str">&quot;red&quot;</span><span class="hl std">,</span> <span class="hl kwc">se</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>  <span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl str">&quot;Valores Previstos&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span> <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">&quot;Dados Testes&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## `geom_smooth()` using formula = 'y ~ x'
</pre></div>
</div><div class="rimage center"><img src="figure/Mini-Projeto-1-ML-CarrosEletricos-Rhtmlunnamed-chunk-10-12.png" alt="plot of chunk unnamed-chunk-10" class="plot" /></div></div>
<div class="chunk" id="unnamed-chunk-11"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">##### Conclusão Final dos Modelo ML  #####</span>
</pre></div>
</div></div>
<div class="chunk" id="unnamed-chunk-12"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">model_desc</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;MSE&quot;</span><span class="hl std">,</span><span class="hl str">&quot;RMSE&quot;</span><span class="hl std">,</span><span class="hl str">&quot;MAE&quot;</span><span class="hl std">,</span><span class="hl str">&quot;R2&quot;</span><span class="hl std">)</span>
<span class="hl std">modelo_v1</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(modelo_v1_mse,modelo_v1_rmse,modelo_v1_mae, modelo_v1_r2)</span>
<span class="hl std">modelo_v2</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(modelo_v2_mse,modelo_v2_rmse,modelo_v2_mae, modelo_v2_r2)</span>


<span class="hl std">result_v1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.data.frame</span><span class="hl std">(</span><span class="hl kwd">cbind</span><span class="hl std">(model_desc, modelo_v1))</span>
<span class="hl std">result_v2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.data.frame</span><span class="hl std">(</span><span class="hl kwd">cbind</span><span class="hl std">(model_desc, modelo_v2))</span>

<span class="hl com"># Modelo 1 tem menor MSE error e tem maior R2, logo o Modelo 1 tem melhor desempenho que modelo 2 </span>
<span class="hl std">result_v1</span>
</pre></div>
<div class="output"><pre class="knitr r">##   model_desc         modelo_v1
## 1        MSE  4.62277553959939
## 2       RMSE  2.15006407802172
## 3        MAE   1.7790413181629
## 4         R2 0.663887572653544
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">result_v2</span>
</pre></div>
<div class="output"><pre class="knitr r">##   model_desc         modelo_v2
## 1        MSE  5.77555404155876
## 2       RMSE  2.40323824069915
## 3        MAE  1.69264035044585
## 4         R2 0.556733196926233
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#model_desc         modelo_v1</span>
<span class="hl com">#1        MSE  2.29984730594314</span>
<span class="hl com">#2       RMSE    1.516524746235</span>
<span class="hl com">#3        MAE  1.14608042292544</span>
<span class="hl com">#4         R2 0.865442359399829</span>
<span class="hl com">#&gt; result_v2</span>
<span class="hl com">#model_desc         modelo_v2</span>
<span class="hl com">#1        MSE  2.74418698128479</span>
<span class="hl com">#2       RMSE  1.65655877688804</span>
<span class="hl com">#3        MAE  1.43847947829882</span>
<span class="hl com">#4         R2 0.743557215863707</span>
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 4.2.2 (2022-10-31 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 22000)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   
## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      
## [5] LC_TIME=Portuguese_Brazil.utf8    
## 
## attached base packages:
## [1] stats4    grid      stats     graphics  grDevices utils     datasets  methods  
## [9] base     
## 
## other attached packages:
##  [1] Metrics_0.1.4        e1071_1.7-13         varImp_0.4           party_1.3-13        
##  [5] strucchange_1.5-3    sandwich_3.0-2       zoo_1.8-12           modeltools_0.2-23   
##  [9] mvtnorm_1.1-3        measures_0.3         randomForest_4.7-1.1 dplyr_1.1.2         
## [13] corrplot_0.92        readxl_1.4.2         caret_6.0-94         lattice_0.21-8      
## [17] ggplot2_3.4.2       
## 
## loaded via a namespace (and not attached):
##  [1] splines_4.2.2        foreach_1.5.2        prodlim_2023.03.31   highr_0.10          
##  [5] coin_1.4-2           cellranger_1.1.0     globals_0.16.2       ipred_0.9-14        
##  [9] pillar_1.9.0         glue_1.6.2           pROC_1.18.0          digest_0.6.31       
## [13] hardhat_1.3.0        colorspace_2.1-0     recipes_1.0.6        Matrix_1.5-1        
## [17] plyr_1.8.8           timeDate_4022.108    pkgconfig_2.0.3      listenv_0.9.0       
## [21] purrr_1.0.1          scales_1.2.1         gower_1.0.1          lava_1.7.2.1        
## [25] timechange_0.2.0     tibble_3.2.1         proxy_0.4-27         mgcv_1.8-41         
## [29] generics_0.1.3       farver_2.1.1         TH.data_1.1-2        withr_2.5.0         
## [33] nnet_7.3-18          cli_3.6.1            survival_3.4-0       magrittr_2.0.3      
## [37] evaluate_0.20        future_1.32.0        fansi_1.0.4          parallelly_1.35.0   
## [41] nlme_3.1-160         MASS_7.3-58.1        class_7.3-20         tools_4.2.2         
## [45] data.table_1.14.8    lifecycle_1.0.3      matrixStats_1.0.0    multcomp_1.4-25     
## [49] stringr_1.5.0        munsell_0.5.0        compiler_4.2.2       rlang_1.1.0         
## [53] iterators_1.0.14     rstudioapi_0.14      labeling_0.4.2       gtable_0.3.3        
## [57] ModelMetrics_1.2.2.2 codetools_0.2-18     reshape2_1.4.4       R6_2.5.1            
## [61] lubridate_1.9.2      knitr_1.42           future.apply_1.10.0  utf8_1.2.3          
## [65] libcoin_1.0-9        stringi_1.7.12       parallel_4.2.2       Rcpp_1.0.10         
## [69] vctrs_0.6.1          rpart_4.1.19         tidyselect_1.2.0     xfun_0.38
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2023-07-20 07:56:52 -03&quot;
</pre></div>
</div></div>


</body>
</html>
